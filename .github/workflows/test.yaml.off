name: secrets test

on:
  pull_request:
    branches: [ main ]

jobs:
  tflint:
    permissions:
      contents: read
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/stv-io/tg-gcp-ci-tools-image/tg-gcp-ci-tools-image:v0.1.5
      options: --user root # https://github.com/actions/checkout/issues/1014
    steps:
      - uses: 'actions/checkout@v3'
      - name: tflint
        env:
          # https://github.com/terraform-linters/tflint/blob/master/docs/user-guide/plugins.md#avoiding-rate-limiting
          GITHUB_TOKEN: ${{ github.token }}
          TFLINT_VERSION: "v0.46.0"
        run: |            
          curl -s https://raw.githubusercontent.com/terraform-linters/tflint/master/install_linux.sh | bash
          tflint --version & tflint --init

          # tflint --version & tflint --init
          #   tflint --recursive --config "$(pwd)/.tflint.hcl"
  
  